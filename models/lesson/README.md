# Lesson 模块说明

## 概述
Lesson 模块用于管理课程表，包括创建课程表目录、发送提醒、处理教师课程表更新等。它与消息系统集成，通知教师课程表的变更。

## 关键功能
- **目录管理**：自动创建当前月份的目录，并组织课程相关文件。
- **课程表更新**：允许更新和通知教师课程表的变更。
- **联系人管理**：检索和管理教师联系信息。

## 函数
### `send_remind(tips, receiver, produce='lesson')`
发送提醒消息到指定接收者。

- **参数**：
  - `tips`：要发送的消息内容。
  - `receiver`：接收者的标识（例如，wxid）。
  - `produce`：发送的消息类型（默认是 'lesson'）。

## Lesson类
Lesson 类用于管理课程表，包括创建课程表目录、发送提醒、处理教师课程表更新等。

### 属性
- `lesson_dir`：课程表目录路径。
- `admin`：接收通知的管理员列表。
- `week_change`：计算当前周数的偏移量。
- `current_month`：当前月份的格式为 YYYYMM。
- `week_info`：当前周的信息，包括周数和时间戳。

### 方法
#### `__init__(self)`
初始化 Lesson 对象，设置必要的目录和加载配置。

#### `get_contacts()`
从指定 URL 检索联系人信息，过滤出特定备注的教师。

#### `month_info() -> str`

#### `update_schedule(self)`
更新课程表。分两种情况：
1. 在上次的基础上更新(微调)，只通知相关有变动的教师，send_remind，上传课表xlsx文件要求如下：
    - 文件名格式： `课表20241014.xlsx`
    - 必须以 `课表` 开头,后面紧跟日期，格式为 `20241014`
    - 日期必须为当周的周一的日期
    - 如果因假期调休等，导致周中上课，仍以周一的日期开头，不上课的日期不填科目
2. 重新更新（新课表变动较大），通知所有教师，send_image， 上传课表图片文件要求如下：
    - 文件名格式： `课表20241014新.xlsx`
    - 必须以 `课表` 开头,后面紧跟日期，格式为 `20241014`，最后跟一个 `新` 字
    - 日期必须为当周的周一的日期
    - 如果因假期调休等，导致周中上课，仍以周一的日期开头，不上课的日期不填科目

#### `lass_schedule(self, class_name)`
获取班级课程表信息。参数：`class_name`
- Usage：
    - 获取班级课程表信息


#### `get_schedule_images(self, class_name)`
从文件中获取课程表图片信息。

## `teacher_schedule(record: any)`
获取教师或班级课程表信息。参数：`record`
- Usage：
    - 获取指定教师的课程表信息： 微信发送： 张三的课表
    - 获取指定班级的课程表信息： 微信发送： 高一3班的课表
    - 获取指定教师本人的课程表信息： 微信发送： 我的课表
    - 更新所有人的课表： 微信发送： 更新所有人的课表
